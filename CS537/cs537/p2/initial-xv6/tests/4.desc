checking return value with properly initialized buffer